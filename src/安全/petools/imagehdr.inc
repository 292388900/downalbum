struct IMAGE_DATA_DIRECTORY
	VirtualAddress	  dd ?
	Size		  dd ?
ends

struct IMAGE_OPTIONAL_HEADER32
	Magic			      dw ?
	MajorLinkerVersion	      db ?
	MinorLinkerVersion	      db ?
	SizeOfCode		      dd ?
	SizeOfInitializedData	      dd ?
	SizeOfUninitializedData       dd ?
	AddressOfEntryPoint	      dd ?
	BaseOfCode		      dd ?
	BaseOfData		      dd ?
	ImageBase		      dd ?
	SectionAlignment	      dd ?
	FileAlignment		      dd ?
	MajorOperatingSystemVersion   dw ?
	MinorOperatingSystemVersion   dw ?
	MajorImageVersion	      dw ?
	MinorImageVersion	      dw ?
	MajorSubsystemVersion	      dw ?
	MinorSubsystemVersion	      dw ?
	Win32VersionValue	      dd ?
	SizeOfImage		      dd ?
	SizeOfHeaders		      dd ?
	CheckSum		      dd ?
	Subsystem		      dw ?
	DllCharacteristics	      dw ?
	SizeOfStackReserve	      dd ?
	SizeOfStackCommit	      dd ?
	SizeOfHeapReserve	      dd ?
	SizeOfHeapCommit	      dd ?
	LoaderFlags		      dd ?
	NumberOfRvaAndSizes	      dd ?
	DataDirectory		      rb (sizeof.IMAGE_DATA_DIRECTORY*16)
ends

IMAGE_OPTIONAL_HEADER  equ  IMAGE_OPTIONAL_HEADER32

struct IMAGE_FILE_HEADER
	Machine 	      dw ?
	NumberOfSections      dw ?
	TimeDateStamp	      dd ?
	PointerToSymbolTable  dd ?
	NumberOfSymbols       dd ?
	SizeOfOptionalHeader  dw ?
	Characteristics       dw ?
ends

struct IMAGE_NT_HEADERS
	Signature	  dd ?
	FileHeader	  IMAGE_FILE_HEADER
	OptionalHeader	  IMAGE_OPTIONAL_HEADER32
ends

struct IMAGE_EXPORT_DIRECTORY
	Characteristics 	  dd ?
	TimeDateStamp		  dd ?
	MajorVersion		  dw ?
	MinorVersion		  dw ?
	nName			  dd ?
	nBase			  dd ?
	NumberOfFunctions	  dd ?
	NumberOfNames		  dd ?
	AddressOfFunctions	  dd ?
	AddressOfNames		  dd ?
	AddressOfNameOrdinals	  dd ?
ends

struct IMAGE_DOS_HEADER
	e_magic 	  dw ?
	e_cblp		  dw ?
	e_cp		  dw ?
	e_crlc		  dw ?
	e_cparhdr	  dw ?
	e_minalloc	  dw ?
	e_maxalloc	  dw ?
	e_ss		  dw ?
	e_sp		  dw ?
	e_csum		  dw ?
	e_ip		  dw ?
	e_cs		  dw ?
	e_lfarlc	  dw ?
	e_ovno		  dw ?
	e_res		  rw 04
	e_oemid 	  dw ?
	e_oeminfo	  dw ?
	e_res2		  rw 10
	e_lfanew	  dd ?
ends

struct IMAGE_SECTION_HEADER
	Name		     rb 8
	label .PhysicalAddress dword
	VirtualSize	     dd ?
	VirtualAddress	     dd ?
	SizeOfRawData	     dd ?
	PointerToRawData     dd ?
	PointerToRelocations dd ?
	PointerToLinenumbers dd ?
	NumberOfRelocations  dw ?
	NumberOfLinenumbers  dw ?
	Characteristics      dd ?
ends

struct IMAGE_IMPORT_DESCRIPTOR
	label .Characteristics dword
	OriginalFirstThunk   dd ?
	TimeDateStamp	     dd ?
	ForwarderChain	     dd ?
	Name		     dd ?
	FirstThunk	     dd ?
ends

IMAGE_DIRECTORY_ENTRY_EXPORT	   =  0
IMAGE_DIRECTORY_ENTRY_IMPORT	   =  1
IMAGE_DIRECTORY_ENTRY_RESOURCE	   =  2
IMAGE_DIRECTORY_ENTRY_EXCEPTION    =  3
IMAGE_DIRECTORY_ENTRY_SECURITY	   =  4
IMAGE_DIRECTORY_ENTRY_BASERELOC    =  5
IMAGE_DIRECTORY_ENTRY_DEBUG	   =  6
IMAGE_DIRECTORY_ENTRY_COPYRIGHT    =  7
IMAGE_DIRECTORY_ENTRY_GLOBALPTR    =  8
IMAGE_DIRECTORY_ENTRY_TLS	   =  9
IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG  = 10
IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT = 11
IMAGE_DIRECTORY_ENTRY_IAT	   = 12
IMAGE_NUMBEROF_DIRECTORY_ENTRIES   = 16

IMAGE_DOS_SIGNATURE = 5A4Dh
IMAGE_OS2_SIGNATURE = 454Eh
IMAGE_OS2_SIGNATURE_LE = 454Ch
IMAGE_VXD_SIGNATURE = 454Ch
IMAGE_NT_SIGNATURE = 00004550h
IMAGE_SIZEOF_FILE_HEADER = 20
IMAGE_FILE_RELOCS_STRIPPED = 0001h
IMAGE_FILE_EXECUTABLE_IMAGE = 0002h
IMAGE_FILE_LINE_NUMS_STRIPPED = 0004h
IMAGE_FILE_LOCAL_SYMS_STRIPPED = 0008h
IMAGE_FILE_AGGRESIVE_WS_TRIM = 0010h
IMAGE_FILE_LARGE_ADDRESS_AWARE = 0020h
IMAGE_FILE_BYTES_REVERSED_LO = 0080h
IMAGE_FILE_32BIT_MACHINE = 0100h
IMAGE_FILE_DEBUG_STRIPPED = 0200h
IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP = 0400h
IMAGE_FILE_NET_RUN_FROM_SWAP = 0800h
IMAGE_FILE_SYSTEM = 1000h
IMAGE_FILE_DLL = 2000h
IMAGE_FILE_UP_SYSTEM_ONLY = 4000h
IMAGE_FILE_BYTES_REVERSED_HI = 8000h
IMAGE_FILE_MACHINE_UNKNOWN = 0
IMAGE_FILE_MACHINE_I386 = 014ch
IMAGE_FILE_MACHINE_R3000 = 0162h
IMAGE_FILE_MACHINE_R4000 = 0166h
IMAGE_FILE_MACHINE_R10000 = 0168h
IMAGE_FILE_MACHINE_WCEMIPSV2 = 0169h
IMAGE_FILE_MACHINE_ALPHA = 0184h
IMAGE_FILE_MACHINE_POWERPC = 01F0h
IMAGE_FILE_MACHINE_SH3 = 01a2h
IMAGE_FILE_MACHINE_SH3E = 01a4h
IMAGE_FILE_MACHINE_SH4 = 01a6h
IMAGE_FILE_MACHINE_ARM = 01c0h
IMAGE_FILE_MACHINE_THUMB = 01c2h
IMAGE_FILE_MACHINE_IA64 = 0200h
IMAGE_FILE_MACHINE_MIPS16 = 0266h
IMAGE_FILE_MACHINE_MIPSFPU = 0366h
IMAGE_FILE_MACHINE_MIPSFPU16 = 0466h
IMAGE_FILE_MACHINE_ALPHA64 = 0284h
IMAGE_FILE_MACHINE_AXP64 = IMAGE_FILE_MACHINE_ALPHA64
IMAGE_SIZEOF_ROM_OPTIONAL_HEADER = 56
IMAGE_SIZEOF_STD_OPTIONAL_HEADER = 28
IMAGE_SIZEOF_NT_OPTIONAL32_HEADER = 224
IMAGE_SIZEOF_NT_OPTIONAL64_HEADER = 240
IMAGE_NT_OPTIONAL_HDR32_MAGIC = 10bh
IMAGE_NT_OPTIONAL_HDR64_MAGIC = 20bh
IMAGE_ROM_OPTIONAL_HDR_MAGIC = 107h
IMAGE_SUBSYSTEM_UNKNOWN = 0
IMAGE_SUBSYSTEM_NATIVE = 1
IMAGE_SUBSYSTEM_WINDOWS_GUI = 2
IMAGE_SUBSYSTEM_WINDOWS_CUI = 3
IMAGE_SUBSYSTEM_OS2_CUI = 5
IMAGE_SUBSYSTEM_POSIX_CUI = 7
IMAGE_SUBSYSTEM_NATIVE_WINDOWS = 8
IMAGE_SUBSYSTEM_WINDOWS_CE_GUI = 9
IMAGE_DLLCHARACTERISTICS_WDM_DRIVER = 2000h
IMAGE_DIRECTORY_ENTRY_EXPORT = 0
IMAGE_DIRECTORY_ENTRY_ARCHITECTURE = 7
IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT = 13
IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR = 14
IMAGE_SIZEOF_SHORT_NAME = 8
IMAGE_SCN_TYPE_NO_PAD = 00000008h
IMAGE_SCN_CNT_CODE = 00000020h
IMAGE_SCN_CNT_INITIALIZED_DATA = 00000040h
IMAGE_SCN_CNT_UNINITIALIZED_DATA = 00000080h
IMAGE_SCN_LNK_OTHER = 00000100h
IMAGE_SCN_LNK_INFO = 00000200h
IMAGE_SCN_LNK_REMOVE = 00000800h
IMAGE_SCN_LNK_COMDAT = 00001000h
IMAGE_SCN_NO_DEFER_SPEC_EXC = 00004000h
IMAGE_SCN_GPREL = 00008000h
IMAGE_SCN_MEM_FARDATA = 00008000h
IMAGE_SCN_MEM_PURGEABLE = 00020000h
IMAGE_SCN_MEM_16BIT = 00020000h
IMAGE_SCN_MEM_LOCKED = 00040000h
IMAGE_SCN_MEM_PRELOAD = 00080000h
IMAGE_SCN_ALIGN_1BYTES = 00100000h
IMAGE_SCN_ALIGN_2BYTES = 00200000h
IMAGE_SCN_ALIGN_4BYTES = 00300000h
IMAGE_SCN_ALIGN_8BYTES = 00400000h
IMAGE_SCN_ALIGN_16BYTES = 00500000h
IMAGE_SCN_ALIGN_32BYTES = 00600000h
IMAGE_SCN_ALIGN_64BYTES = 00700000h
IMAGE_SCN_ALIGN_128BYTES = 00800000h
IMAGE_SCN_ALIGN_256BYTES = 00900000h
IMAGE_SCN_ALIGN_512BYTES = 00A00000h
IMAGE_SCN_ALIGN_1024BYTES = 00B00000h
IMAGE_SCN_ALIGN_2048BYTES = 00C00000h
IMAGE_SCN_ALIGN_4096BYTES = 00D00000h
IMAGE_SCN_ALIGN_8192BYTES = 00E00000h
IMAGE_SCN_LNK_NRELOC_OVFL = 01000000h
IMAGE_SCN_MEM_DISCARDABLE = 02000000h
IMAGE_SCN_MEM_NOT_CACHED = 04000000h
IMAGE_SCN_MEM_NOT_PAGED = 08000000h
IMAGE_SCN_MEM_SHARED = 10000000h
IMAGE_SCN_MEM_EXECUTE = 20000000h
IMAGE_SCN_MEM_READ = 40000000h
IMAGE_SCN_MEM_WRITE = 80000000h
IMAGE_SCN_SCALE_INDEX = 00000001h
IMAGE_SIZEOF_SYMBOL = 18
IMAGE_SYM_UNDEFINED = 0
IMAGE_SYM_ABSOLUTE = -1
IMAGE_SYM_DEBUG = -2
IMAGE_SYM_TYPE_NULL = 0000h
IMAGE_SYM_TYPE_VOID = 0001h
IMAGE_SYM_TYPE_CHAR = 0002h
IMAGE_SYM_TYPE_SHORT = 0003h
IMAGE_SYM_TYPE_INT = 0004h
IMAGE_SYM_TYPE_LONG = 0005h
IMAGE_SYM_TYPE_FLOAT = 0006h
IMAGE_SYM_TYPE_DOUBLE = 0007h
IMAGE_SYM_TYPE_STRUCT = 0008h
IMAGE_SYM_TYPE_UNION = 0009h
IMAGE_SYM_TYPE_ENUM = 000Ah
IMAGE_SYM_TYPE_MOE = 000Bh
IMAGE_SYM_TYPE_BYTE = 000Ch
IMAGE_SYM_TYPE_WORD = 000Dh
IMAGE_SYM_TYPE_UINT = 000Eh
IMAGE_SYM_TYPE_DWORD = 000Fh
IMAGE_SYM_TYPE_PCODE = 8000h
IMAGE_SYM_DTYPE_NULL = 0
IMAGE_SYM_DTYPE_POINTER = 1
IMAGE_SYM_DTYPE_FUNCTION = 2
IMAGE_SYM_DTYPE_ARRAY = 3
IMAGE_SYM_CLASS_END_OF_FUNCTION = -1
IMAGE_SYM_CLASS_NULL = 0000h
IMAGE_SYM_CLASS_AUTOMATIC = 0001h
IMAGE_SYM_CLASS_EXTERNAL = 0002h
IMAGE_SYM_CLASS_STATIC = 0003h
IMAGE_SYM_CLASS_REGISTER = 0004h
IMAGE_SYM_CLASS_EXTERNAL_DEF = 0005h
IMAGE_SYM_CLASS_LABEL = 0006h
IMAGE_SYM_CLASS_UNDEFINED_LABEL = 0007h
IMAGE_SYM_CLASS_MEMBER_OF_STRUCT = 0008h
IMAGE_SYM_CLASS_ARGUMENT = 0009h
IMAGE_SYM_CLASS_STRUCT_TAG = 000Ah
IMAGE_SYM_CLASS_MEMBER_OF_UNION = 000Bh
IMAGE_SYM_CLASS_UNION_TAG = 000Ch
IMAGE_SYM_CLASS_TYPE_DEFINITION = 000Dh
IMAGE_SYM_CLASS_UNDEFINED_STATIC = 000Eh
IMAGE_SYM_CLASS_ENUM_TAG = 000Fh
IMAGE_SYM_CLASS_MEMBER_OF_ENUM = 0010h
IMAGE_SYM_CLASS_REGISTER_PARAM = 0011h
IMAGE_SYM_CLASS_BIT_FIELD = 0012h
IMAGE_SYM_CLASS_FAR_EXTERNAL = 0044h
IMAGE_SYM_CLASS_BLOCK = 0064h
IMAGE_SYM_CLASS_FUNCTION = 0065h
IMAGE_SYM_CLASS_END_OF_STRUCT = 0066h
IMAGE_SYM_CLASS_FILE = 0067h
IMAGE_SYM_CLASS_SECTION = 0068h
IMAGE_SYM_CLASS_WEAK_EXTERNAL = 0069h
IMAGE_SIZEOF_AUX_SYMBOL = 18
IMAGE_COMDAT_SELECT_NODUPLICATES = 1
IMAGE_COMDAT_SELECT_ANY = 2
IMAGE_COMDAT_SELECT_SAME_SIZE = 3
IMAGE_COMDAT_SELECT_EXACT_MATCH = 4
IMAGE_COMDAT_SELECT_ASSOCIATIVE = 5
IMAGE_COMDAT_SELECT_LARGEST = 6
IMAGE_COMDAT_SELECT_NEWEST = 7
IMAGE_WEAK_EXTERN_SEARCH_NOLIBRARY = 1
IMAGE_WEAK_EXTERN_SEARCH_LIBRARY = 2
IMAGE_WEAK_EXTERN_SEARCH_ALIAS = 3
IMAGE_SIZEOF_RELOCATION = 10
IMAGE_REL_I386_ABSOLUTE = 0000h
IMAGE_REL_I386_DIR16 = 0001h
IMAGE_REL_I386_REL16 = 0002h
IMAGE_REL_I386_DIR32 = 0006h
IMAGE_REL_I386_DIR32NB = 0007h
IMAGE_REL_I386_SEG12 = 0009h
IMAGE_REL_I386_SECTION = 000Ah
IMAGE_REL_I386_SECREL = 000Bh
IMAGE_REL_I386_REL32 = 0014h
IMAGE_SIZEOF_LINENUMBER = 6
IMAGE_SIZEOF_BASE_RELOCATION = 8
IMAGE_REL_BASED_ABSOLUTE = 0
IMAGE_REL_BASED_HIGH = 1
IMAGE_REL_BASED_LOW = 2
IMAGE_REL_BASED_HIGHLOW = 3
IMAGE_REL_BASED_HIGHADJ = 4
IMAGE_REL_BASED_MIPS_JMPADDR = 5
IMAGE_REL_BASED_SECTION = 6
IMAGE_REL_BASED_REL32 = 7
IMAGE_REL_BASED_MIPS_JMPADDR16 = 9
IMAGE_REL_BASED_IA64_IMM64 = 9
IMAGE_REL_BASED_DIR64 = 10
IMAGE_REL_BASED_HIGH3ADJ = 11
IMAGE_ARCHIVE_START_SIZE = 8
IMAGE_ARCHIVE_START equ <"!<arch>",10>
IMAGE_ARCHIVE_END equ <"`",10>
IMAGE_ARCHIVE_PAD = 10
IMAGE_ARCHIVE_LINKER_MEMBER equ <"/               ">
IMAGE_ARCHIVE_LONGNAMES_MEMBER equ <"//              ">
IMAGE_SIZEOF_ARCHIVE_MEMBER_HDR = 60
IMAGE_ORDINAL_FLAG32 = 80000000h
IMAGE_RESOURCE_NAME_IS_STRING = 80000000h
IMAGE_RESOURCE_DATA_IS_DIRECTORY = 80000000h
IMAGE_DEBUG_TYPE_UNKNOWN = 0
IMAGE_DEBUG_TYPE_COFF = 1
IMAGE_DEBUG_TYPE_CODEVIEW = 2
IMAGE_DEBUG_TYPE_FPO = 3
IMAGE_DEBUG_TYPE_MISC = 4
IMAGE_DEBUG_TYPE_EXCEPTION = 5
IMAGE_DEBUG_TYPE_FIXUP = 6
IMAGE_DEBUG_TYPE_OMAP_TO_SRC = 7
IMAGE_DEBUG_TYPE_OMAP_FROM_SRC = 8
IMAGE_DEBUG_TYPE_BORLAND = 9
IMAGE_DEBUG_TYPE_RESERVED10 = 10
IMAGE_DEBUG_MISC_EXENAME = 1
IMAGE_SEPARATE_DEBUG_SIGNATURE = 4944h
IMAGE_SEPARATE_DEBUG_FLAGS_MASK = 8000h
IMAGE_SEPARATE_DEBUG_MISMATCH = 8000h